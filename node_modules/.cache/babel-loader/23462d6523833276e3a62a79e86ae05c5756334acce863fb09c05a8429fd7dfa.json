{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\HP\\\\Desktop\\\\ikwa-clean-frontend\\\\src\\\\contexts\\\\UserContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useReducer, useEffect } from \"react\";\nimport { authService, userService } from \"../services/api\";\nimport { toast } from \"react-hot-toast\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext();\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  loading: false,\n  error: null\n};\nconst userReducer = (state, action) => {\n  switch (action.type) {\n    case \"AUTH_START\":\n      return {\n        ...state,\n        loading: true,\n        error: null\n      };\n    case \"LOGIN_SUCCESS\":\n      return {\n        ...state,\n        user: action.payload,\n        isAuthenticated: true,\n        loading: false,\n        error: null\n      };\n    case \"REGISTER_SUCCESS\":\n      return {\n        ...state,\n        loading: false,\n        error: null\n      };\n    case \"AUTH_ERROR\":\n      return {\n        ...state,\n        loading: false,\n        error: action.payload\n      };\n    case \"LOGOUT\":\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n};\nexport const UserProvider = ({\n  children\n}) => {\n  _s();\n  const [state, dispatch] = useReducer(userReducer, initialState, () => {\n    const savedUser = localStorage.getItem(\"user\");\n    const token = localStorage.getItem(\"token\");\n    return {\n      ...initialState,\n      user: savedUser ? JSON.parse(savedUser) : null,\n      isAuthenticated: !!token\n    };\n  });\n\n  // Persist user\n  useEffect(() => {\n    if (state.user) {\n      localStorage.setItem(\"user\", JSON.stringify(state.user));\n    } else {\n      localStorage.removeItem(\"user\");\n    }\n  }, [state.user]);\n\n  // --- AUTH METHODS -----------------------------------\n\n  const register = async form => {\n    dispatch({\n      type: \"AUTH_START\"\n    });\n    try {\n      const payload = {\n        firstName: form.firstName,\n        lastName: form.lastName,\n        email: form.email,\n        password: form.password,\n        confirmPassword: form.confirmPassword,\n        country: form.country\n      };\n      const res = await authService.register(payload);\n      dispatch({\n        type: \"REGISTER_SUCCESS\"\n      });\n      toast.success(\"Registration successful!\");\n      return res; // RegisterPage will handle redirect\n    } catch (err) {\n      var _err$response, _err$response$data;\n      const msg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message || \"Registration failed\";\n      dispatch({\n        type: \"AUTH_ERROR\",\n        payload: msg\n      });\n      toast.error(msg);\n      throw err;\n    }\n  };\n  const login = async credentials => {\n    dispatch({\n      type: \"AUTH_START\"\n    });\n    try {\n      const res = await authService.login(credentials);\n      const token = res === null || res === void 0 ? void 0 : res.token;\n      const user = res === null || res === void 0 ? void 0 : res.user;\n      if (!token || !user) throw new Error(\"Invalid login response from backend\");\n      localStorage.setItem(\"token\", token);\n      localStorage.setItem(\"user\", JSON.stringify(user));\n      dispatch({\n        type: \"LOGIN_SUCCESS\",\n        payload: user\n      });\n      toast.success(\"Welcome back!\");\n      return user;\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      const msg = ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || err.message || \"Login failed\";\n      dispatch({\n        type: \"AUTH_ERROR\",\n        payload: msg\n      });\n      toast.error(msg);\n      throw err;\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    dispatch({\n      type: \"LOGOUT\"\n    });\n    toast.success(\"Logged out\");\n  };\n  const updateProfile = async data => {\n    try {\n      const res = await userService.updateProfile(data);\n      localStorage.setItem(\"user\", JSON.stringify(res));\n      dispatch({\n        type: \"LOGIN_SUCCESS\",\n        payload: res\n      });\n      toast.success(\"Profile updated\");\n      return res;\n    } catch (err) {\n      toast.error(\"Update failed\");\n      throw err;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      ...state,\n      login,\n      register,\n      logout,\n      updateProfile\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 5\n  }, this);\n};\n_s(UserProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n_c = UserProvider;\nexport const useUser = () => {\n  _s2();\n  return useContext(UserContext);\n};\n_s2(useUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport default UserContext;\nvar _c;\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","authService","userService","toast","jsxDEV","_jsxDEV","UserContext","initialState","user","isAuthenticated","loading","error","userReducer","state","action","type","payload","UserProvider","children","_s","dispatch","savedUser","localStorage","getItem","token","JSON","parse","setItem","stringify","removeItem","register","form","firstName","lastName","email","password","confirmPassword","country","res","success","err","_err$response","_err$response$data","msg","response","data","message","login","credentials","Error","_err$response2","_err$response2$data","logout","updateProfile","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useUser","_s2","$RefreshReg$"],"sources":["C:/Users/HP/Desktop/ikwa-clean-frontend/src/contexts/UserContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from \"react\";\r\nimport { authService, userService } from \"../services/api\";\r\nimport { toast } from \"react-hot-toast\";\r\n\r\nconst UserContext = createContext();\r\n\r\nconst initialState = {\r\n  user: null,\r\n  isAuthenticated: false,\r\n  loading: false,\r\n  error: null,\r\n};\r\n\r\nconst userReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"AUTH_START\":\r\n      return { ...state, loading: true, error: null };\r\n\r\n    case \"LOGIN_SUCCESS\":\r\n      return {\r\n        ...state,\r\n        user: action.payload,\r\n        isAuthenticated: true,\r\n        loading: false,\r\n        error: null,\r\n      };\r\n\r\n    case \"REGISTER_SUCCESS\":\r\n      return { ...state, loading: false, error: null };\r\n\r\n    case \"AUTH_ERROR\":\r\n      return { ...state, loading: false, error: action.payload };\r\n\r\n    case \"LOGOUT\":\r\n      return { ...initialState };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport const UserProvider = ({ children }) => {\r\n  const [state, dispatch] = useReducer(userReducer, initialState, () => {\r\n    const savedUser = localStorage.getItem(\"user\");\r\n    const token = localStorage.getItem(\"token\");\r\n\r\n    return {\r\n      ...initialState,\r\n      user: savedUser ? JSON.parse(savedUser) : null,\r\n      isAuthenticated: !!token,\r\n    };\r\n  });\r\n\r\n  // Persist user\r\n  useEffect(() => {\r\n    if (state.user) {\r\n      localStorage.setItem(\"user\", JSON.stringify(state.user));\r\n    } else {\r\n      localStorage.removeItem(\"user\");\r\n    }\r\n  }, [state.user]);\r\n\r\n  // --- AUTH METHODS -----------------------------------\r\n\r\n  const register = async (form) => {\r\n    dispatch({ type: \"AUTH_START\" });\r\n\r\n    try {\r\n      const payload = {\r\n        firstName: form.firstName,\r\n        lastName: form.lastName,\r\n        email: form.email,\r\n        password: form.password,\r\n        confirmPassword: form.confirmPassword,\r\n        country: form.country,\r\n      };\r\n\r\n      const res = await authService.register(payload);\r\n\r\n      dispatch({ type: \"REGISTER_SUCCESS\" });\r\n      toast.success(\"Registration successful!\");\r\n\r\n      return res; // RegisterPage will handle redirect\r\n    } catch (err) {\r\n      const msg =\r\n        err.response?.data?.message || err.message || \"Registration failed\";\r\n      dispatch({ type: \"AUTH_ERROR\", payload: msg });\r\n      toast.error(msg);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const login = async (credentials) => {\r\n    dispatch({ type: \"AUTH_START\" });\r\n\r\n    try {\r\n      const res = await authService.login(credentials);\r\n\r\n      const token = res?.token;\r\n      const user = res?.user;\r\n\r\n      if (!token || !user)\r\n        throw new Error(\"Invalid login response from backend\");\r\n\r\n      localStorage.setItem(\"token\", token);\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n\r\n      dispatch({ type: \"LOGIN_SUCCESS\", payload: user });\r\n\r\n      toast.success(\"Welcome back!\");\r\n\r\n      return user;\r\n    } catch (err) {\r\n      const msg =\r\n        err.response?.data?.message || err.message || \"Login failed\";\r\n      dispatch({ type: \"AUTH_ERROR\", payload: msg });\r\n      toast.error(msg);\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    localStorage.removeItem(\"user\");\r\n    dispatch({ type: \"LOGOUT\" });\r\n    toast.success(\"Logged out\");\r\n  };\r\n\r\n  const updateProfile = async (data) => {\r\n    try {\r\n      const res = await userService.updateProfile(data);\r\n      localStorage.setItem(\"user\", JSON.stringify(res));\r\n      dispatch({ type: \"LOGIN_SUCCESS\", payload: res });\r\n      toast.success(\"Profile updated\");\r\n      return res;\r\n    } catch (err) {\r\n      toast.error(\"Update failed\");\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <UserContext.Provider\r\n      value={{\r\n        ...state,\r\n        login,\r\n        register,\r\n        logout,\r\n        updateProfile,\r\n      }}\r\n    >\r\n      {children}\r\n    </UserContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useUser = () => useContext(UserContext);\r\n\r\nexport default UserContext;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}